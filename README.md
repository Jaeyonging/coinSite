# 🪙 김치프리미엄 체크 사이트

업비트와 바이낸스 간의 암호화폐 가격 차이를 실시간으로 확인할 수 있는 웹사이트다.

🌐 **배포 사이트**: [https://coin-site-tau.vercel.app/](https://coin-site-tau.vercel.app/)

---

## 프로젝트 소개

암호화폐 거래를 하면서 "지금 김치프리미엄이 얼마나 되지?"라는 궁금증이 생겼다. 매번 업비트와 바이낸스를 번갈아가며 확인하는 게 번거로워서, 한 화면에서 실시간으로 비교할 수 있는 사이트를 만들기로 했다.

처음엔 가격만 보여주면 될 줄 알았는데, 막상 만들다 보니 정렬, 검색, 그래프, 즐겨찾기 등 생각보다 많은 기능이 필요했다. 그 과정에서 많은 걸 배웠다.

---

## 주요 기능

- **실시간 가격 업데이트**: WebSocket으로 업비트와 바이낸스 가격을 실시간으로 받아온다
- **김치프리미엄 계산**: 한국 가격과 해외 가격(USDT * 환율)을 비교해서 퍼센트로 표시
- **캔들스틱 차트**: SVG로 직접 구현한 차트, 호버하면 상세 정보 표시
- **즐겨찾기**: 쿠키에 저장해서 새로고침해도 유지됨
- **검색 & 정렬**: 코인 이름 검색, 가격/김치프리미엄/변동률로 정렬
- **모바일 최적화**: 테이블 형식으로 가로 스크롤 없이 모든 정보 표시

---

## 기술 스택

- **React 18 + TypeScript**: 타입 안정성을 위해 TypeScript 사용
- **Vite**: 빠른 빌드 속도와 HMR
- **Redux Toolkit**: 전역 상태 관리
- **React Bootstrap**: 테이블 컴포넌트
- **react-icons**: 아이콘
- **WebSocket**: 업비트, 바이낸스 실시간 데이터
- **Vercel**: 배포
- **Google Analytics**: 사용자 분석

---

## 프로젝트 구조

```
src/
├── api/
│   ├── services/          # API 호출 함수들
│   └── types/             # API 응답 타입 정의
├── components/            # 컴포넌트들
├── hooks/                 # 커스텀 훅
├── store/                 # Redux 스토어
├── utils/                 # 유틸리티 함수
└── pages/                 # 페이지
```

처음엔 모든 로직을 한 파일에 때려넣었다가, 나중에 컴포넌트와 훅으로 분리했다. 확실히 유지보수가 쉬워졌다.

---

## 개발하면서 배운 점

### WebSocket 메시지 처리와 성능 최적화

업비트 WebSocket이 Blob 형식으로 데이터를 보내주는데, 처음엔 `FileReader`를 썼다. 그런데 코드가 복잡해지고, `Blob.text()`가 더 간단하다는 걸 나중에 알았다. 작은 것들이지만 이런 걸 알게 되는 게 재밌다.

진짜 문제는 메시지가 너무 빨리 와서 Redux dispatch가 과도하게 발생하는 거였다. 화면이 버벅거리기 시작했고, 개발자 도구를 보니 초당 수십 번씩 dispatch가 일어나고 있었다. 이걸 해결하려고 `requestAnimationFrame`으로 배치 처리하니 훨씬 부드러워졌다. 

실시간 데이터를 다룰 때는 이런 최적화가 정말 중요하다는 걸 느꼈다. 단순히 데이터를 받아서 상태에 넣는 게 아니라, 언제 어떻게 업데이트할지도 고민해야 한다.

### React 성능 최적화의 중요성

가격이 업데이트될 때마다 전체 테이블이 리렌더링되면서 화면이 버벅거렸다. 처음엔 뭐가 문제인지도 모르겠고, 그냥 "React가 느린가?" 싶었다. 

`React.memo`로 컴포넌트를 감싸고, `useMemo`와 `useCallback`을 적절히 사용하니 확실히 나아졌다. Redux store 설정에서 `immutableCheck: false`로 설정하는 것도 도움이 됐다. 

이 과정에서 배운 건, 성능 문제는 보통 한 곳에 있는 게 아니라 여러 곳에서 조금씩 누적되는 거라는 거다. 하나씩 최적화해나가면서 점점 부드러워지는 걸 보는 게 뿌듯했다.

### 모바일 반응형의 어려움

모바일에서 테이블을 보여주는 게 생각보다 어려웠다. 처음엔 카드 형식으로 만들었는데, 사용자가 테이블 형식을 원해서 다시 바꿨다. 

폰트 크기를 줄이고, 패딩을 최소화하고, 컬럼 너비를 조정해도 가로 스크롤이 생겼다. `table-layout: fixed`를 쓰고 각 컬럼에 명시적으로 너비를 지정하니 해결됐다. 

모바일에서는 정말 픽셀 단위로 신경 써야 한다는 걸 느꼈다. 데스크톱에서는 문제없던 게 모바일에서는 완전히 깨졌었다. 미디어 쿼리로 하나하나 조정하는 게 번거로웠지만, 결과를 보니 그럴 만했다.

### Redux와 로컬 상태의 균형

Redux를 처음 써봤는데, 처음엔 모든 상태를 Redux에 넣으려고 했다. 검색어도, 정렬 설정도, 차트 열림 상태도 전부. 그런데 이게 오히려 복잡해졌다.

나중에 깨달은 건, 정말 전역으로 공유해야 하는 상태(가격 데이터, 코인 목록)만 Redux에 넣고, 나머지는 `useState`로 관리하는 게 훨씬 간단하다는 거다. 

Redux Toolkit의 `createSlice`가 정말 편했다. 기존 Redux처럼 액션 타입, 액션 크리에이터, 리듀서를 각각 작성할 필요 없이 한 곳에서 정의할 수 있어서 코드가 훨씬 간결해졌다. `immer`가 내장되어 있어서 불변성 신경 안 써도 되는 것도 좋았다.

### TypeScript 타입 가드의 유용성

WebSocket 메시지 같은 동적 데이터를 다룰 때 타입 가드가 정말 유용했다. `if (parsed.data && parsed.data.s && parsed.data.p)` 같은 체크를 타입으로 보장할 수 있어서, 그 이후 코드에서는 안전하게 속성에 접근할 수 있었다.

처음엔 타입 정의하는 게 번거로웠지만, 나중에 API가 변경됐을 때 에디터에서 바로 에러를 잡아주니까 디버깅 시간이 확실히 줄었다. 런타임 에러보다 컴파일 타임 에러가 훨씬 찾기 쉽다.

### 컴포넌트 분리의 중요성

처음엔 큰 컴포넌트 하나에 모든 걸 때려넣었다. 그런데 나중에 수정하려고 보니 어디가 뭘 하는지 찾기 어려웠다. 

작은 컴포넌트로 분리하면서 재사용성과 가독성이 훨씬 좋아졌다. 특히 테이블 셀들을 각각 컴포넌트로 분리한 게 좋은 선택이었다. 나중에 스타일을 바꾸거나 기능을 추가할 때도 해당 컴포넌트만 수정하면 돼서 편했다.

---

## 어려웠던 점

### 바이낸스 WebSocket 데이터 파싱

바이낸스는 스트림 형식으로 여러 코인을 한 번에 보내주는데, 데이터 구조가 복잡했다. `{ stream: "...", data: { s: "BTCUSDT", p: "50000" } }` 형식이라서 파싱하는데 시간이 걸렸다.

특히 심볼을 `BTCUSDT` → `BTC`로 변환하고 대문자로 만드는 걸 깜빡해서 한참 디버깅했다. 가격이 업데이트가 안 되는 줄 알고 WebSocket 연결 문제인 줄 알았는데, 알고 보니 심볼 매칭이 안 돼서였다. 

이런 작은 실수 하나가 몇 시간을 날릴 수 있다는 걸 뼈저리게 느꼈다. 디버깅할 때는 항상 데이터를 콘솔에 찍어보는 게 중요하다.

### 실시간 업데이트 성능 문제

가격이 업데이트될 때마다 애니메이션이 실행되면서 성능이 저하됐다. 처음엔 배경색 애니메이션을 썼는데, 이게 너무 무거웠다. 텍스트 색상 애니메이션으로 바꿨는데도 부드럽지 않았다.

`requestAnimationFrame`으로 배치 처리하니 훨씬 나아졌다. 하지만 여전히 완벽하지는 않다. 실시간으로 수십 개의 가격이 동시에 업데이트되면 어느 정도 버벅거림은 피할 수 없는 것 같다.

이 과정에서 배운 건, 애니메이션은 신중하게 써야 한다는 거다. 모든 걸 애니메이션으로 만들면 오히려 사용자 경험이 나빠질 수 있다.

### 모바일 레이아웃의 한계

모바일에서 테이블을 보여주면서도 가로 스크롤 없이 모든 정보를 보여주는 게 어려웠다. 폰트 크기를 줄이고, 패딩을 최소화하고, 컬럼 너비를 조정해도 여전히 공간이 부족했다.

결국 일부 컬럼을 숨기거나, 폰트 크기를 더 줄이거나, 레이아웃을 바꿔야 했다. 완벽한 해결책은 없었고, 타협점을 찾는 게 중요했다.

모바일에서는 정말 제약이 많다는 걸 느꼈다. 데스크톱에서는 당연하게 보여줄 수 있는 정보도 모바일에서는 포기해야 할 때가 있다.

### SVG 차트 구현의 복잡함

SVG로 캔들스틱 차트를 직접 그리는 게 생각보다 복잡했다. 가격 범위 계산, Y축 좌표 변환, 시간 단위별 라벨 표시 등 고려할 게 많았다.

특히 스크롤을 고려한 툴팁 위치 계산이 까다로웠다. 처음엔 단순히 마우스 위치에 툴팁을 띄웠는데, 스크롤하면 위치가 어긋났다. `getBoundingClientRect()`를 써서 정확한 위치를 계산하니 해결됐다.

라이브러리를 쓰면 이런 걸 다 해결해주지만, 직접 구현하면서 더 세밀하게 커스터마이징할 수 있어서 좋았다. 다만 시간이 많이 걸렸다.

---

## 앞으로 개선하고 싶은 점

1. **차트 기능 강화** - 이동평균선이나 볼린저 밴드 같은 기술적 지표 추가
2. **알림 기능** - 특정 김치프리미엄 수준에 도달하면 알림
3. **히스토리 데이터** - 과거 김치프리미엄 추이를 그래프로 표시
4. **다른 거래소 추가** - 바이낸스 말고 다른 거래소도 비교
5. **성능 최적화** - 가상화(virtualization) 적용해서 더 많은 코인 부드럽게 표시

---

## 설치 및 실행

```bash
# 의존성 설치
npm install

# 개발 서버 실행
npm run dev

# 빌드
npm run build
```

환경 변수는 `.env` 파일에 설정하면 된다:
```
VITE_GA_PROPERTYID=your_ga_id
```

---

## 후기

처음엔 단순히 가격만 보여주면 될 줄 알았는데, 막상 만들다 보니 생각보다 많은 기능이 필요했다. WebSocket을 다루고, 성능 최적화를 하고, 모바일 반응형을 구현하면서 실무에 가까운 경험을 할 수 있었다.

아직 부족한 점이 많지만, 계속 개선해나가면서 더 나은 서비스로 만들어가고 싶다.
